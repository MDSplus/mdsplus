<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>


<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="Author" content="Gabriele Manduchi">
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>jScope</title>
</head>

<body>

<blockquote>
  <blockquote>
    <blockquote>
      <b><font size="+3"><p align="center">&nbsp;</font><font size="7">jScope</font></b><big><big><big>
      </big></big></big></p>
    </blockquote>
    <p align="center"><img SRC="jScope.jpg" height="496" width="765"> </p>
    <p>jScope is a Java tool for the display of waveforms. Its concepts derive from the
    MDSPlus Scope, the MDSplus tool for data visualization. jScope adds new features, such as
    color support and error bars. <br>
    With jScope it is possible to define a set of panels and a set of waveforms is associated
    with each panel. Once the Waveform(s) have been displayed, it is possible to zoom parts of
    them, to move a cursor in order to get exact coordinates, and to drag waveforms. </p>
    <p>Following is a brief&nbsp; summary of the options currently available in jScope: </p>
    <p><b>Main Menu bar</b>: <ul>
      <li>&nbsp;<b><u>File</u>:</b></li>
      <li><u>Browse signals:</u> activates a browsing tool for navigating into the structure of
        the pulse file. This option is enabled only if the corresponding data server supports
        signal browsing, as defined in the property file.</li>
      <li><u>New Window:</u> creates a new jScope windows</li>
      <li><u>Look &amp; Feel</u>: defines the interface aspect of jScope (Motif, Java, Windows,
        Mac)</li>
      <li><u>Close</u>: closes the current window</li>
      <li><u>Exit:</u> quit the application</li>
    </ul>
  </blockquote>
  <ul>
    <li>&nbsp;<b><u>Pointer mode</u></b>: defines the current mouse behaviour, which can be set
      as follows:</li>
    <ul>
      <li><u>Point:</u> in this configuration, a crosshair is present on each panel, and can be
        moved over the waveform.&nbsp; The corresponding point coordinates are displayed&nbsp; on
        a bottom line, and crosshairs on the other panels are moved accordingly to the time
        coordinates of the selected crosshair. When more than one waveform is displayed on the same
        panel, clicking the mouse near one waveform, locks the crosshair to the selected waveform
        (as indicated also by the colour of the crosshair). The bottom line indicates which
        waveform is currently selected. Clicking MB2 mouse button when in point mode sets all the
        scales of the waveforms (both X and Y) to the scale of the selected panel.</li>
      <li><u>Zoom</u>: when in Zoom mode it is possible to drag the mouse in order to define a
        zoom region. Clicking MB1 mouse button when in Zoom mode also enlarges the waveform,
        centered around the current mouse position.</li>
      <li><u>Pan</u>: when in Pan mode, it is possible to drag the waveform(s) of the selected
        panel.</li>
      <li><u>Copy</u>: in Copy mode, it is possible to select one panel (clicking MB1 mouse
        button) and copy its contents in the other panels (clicking MB2 mouse button). Deselection
        is made by clicking MB2 mouse button in the selected panel. Pointer modes are also
        selectable using the bottom radio boxes.</li>
    </ul>
    <li><b><u>Prin</u>t</b>:</li>
    <blockquote>
    </blockquote>
    <li><u>Print All:</u> prints all the waveforms.</li>
  </ul>
</blockquote>

<ul>
  <li>&nbsp;<b><u>Customize</u></b>:</li>
  <blockquote>
  </blockquote>
  <li><u>Global Setting</u>: defines a subset of the waveform settings which is valid for all
    waveforms (see description of waveform settings below).&nbsp; From this dialog it is
    possible to define the following configurations:<br>
    - number of vertical and horizontal lines in the grid;<br>
    - appearance of the grid;<br>
    - vertical and horizontal offset, i.e. the dimension of the blank area between the drawn
    waveform and the panel border, when the waveform is autoscaled;<br>
    - reversed image (i.e. black foreground);<br>
    - legend position;<br>
    - use of color palette (recirculate over shot numbers or over signal names)</li>
  <li><u>Window</u>: defines the number of panels. Panels can then be re-dimensioned by
    dragging the small handles between panels</li>
  <li><u>Printer</u>: to be used for printer selection. It appears only using JDK 1.2.</li>
  <li><u>Page setup</u>: It appears only using JDK 1.2, to be used for page orientation and
    print margins.</li>
  <li><u>Font Selection:</u> defines the font to be used for labels and numbers in jScope</li>
  <li><u>Color list</u>: defines the color palette, which is then used to assign colors to
    waveforms.</li>
  <li><u>Public variables</u>: defines the context for data access (see customization section
    for using this feature in non MDSPlus systems)</li>
  <li><u>Brief error</u>: defines complete or reduced error reporting (MDSPlus version only).</li>
  <li><u>Use last Saved Setting, Use Saved Setting from...</u><i> </i>: retrieve the a saved
    jScope configuration. jScope configurations can be saved in files, and reloaded at any
    time. The name of a configuration file can be defined as a command argument. e.g. java
    jScope &lt;configuration filename&gt;.</li>
  <li><u>Save current setting, Save current setting as</u>: save current configuration in a
    file.</li>
  <li><u>Save all as text...</u>: Saves the currently displayed signals in a textual,
    matlab-compatible format. The produced file begins with three descriptive rows: the first
    one describes X axis for the&nbsp; signal list, the second one describes the Y axis, and
    the third row reports the shot numbers. In the remaining rows X and Y values for signals
    are saved in ASCII as columns. Successive signals are displayed in successive columns.<br>
    <br>
  </li>
  <li><b><u>Autoscale:</u></b> used to redisplay full waveforms (e.g. after zooming or
    dragging) it is a subset of a popup menu described below.</li>
</ul>

<ul>
  <blockquote>
  </blockquote>
  <li><u>All</u>: autoscale all signals</li>
  <li><u>All y</u>: autoscale only y values.<br>
    <br>
    <br>
  </li>
  <li><b><u>Network</u></b>: defines current connection to data.</li>
  <blockquote>
  </blockquote>
  <li><u>Fast network access</u>: enables data reduction over the network, if supported by the
    data server.</li>
  <li><u>Enables signal cache</u>: enable local caching for signals.</li>
  <li><u>Free cache:</u> force local signal cache free so that subsequent signal access will
    be requested to the data server.</li>
  <li><u>Enable compression:</u> enables data compression in communication, if supported by
    the currently selected data server.</li>
  <li><u>Servers</u>: defines data source. A server can be local or remote. In the latter case
    it is defined by its IP address. The current server can be defined at the command line as
    follows: java -Ddata.address=&lt;IP address&gt; jScope. The current server is displayed in
    the bottom line on the right.</li>
  <li><u>Edit server list</u>: allows adding new servers on the server list. Each data server
    is defined by:<br>
    - <em>name</em>: which appears then in the server list<br>
    -<em>class</em>: the type of the server, selected from a list (based on the content of the
    property file)<br>
    -<em>argument</em>(optional): passed to the created data server. Its meaning depends on
    the kind of selected server. In MdsDataServer, for example, the argument is the ip address
    of the remote data server.<br>
    -<em>user</em>(optional): the username definition to be passed to the data server. Can be
    defined as the local username.</li>
</ul>

<p>&nbsp;</p>

<p><br>
<b>Popup Menu</b> <br>
A popup menu is displayed clicking MB3 mouse button on a panel (except in Copy mode) as
follows: </p>

<p align="center"><br>
<br>
&nbsp; <img src="popup.jpg" width="640" height="627" alt="popup.jpg (52087 byte)"><br>
&nbsp; </p>

<p>The item <strong>Setup data source...</strong> of this menu defines the contents of the
selected panel and activates a setup form. The form is as follows </p>

<p align="center"><br>
<img src="data_setup.jpg" width="754" height="510" alt="data_setup.jpg (47143 byte)"></p>

<p>and defines the following fields: </p>

<blockquote>
  <ul>
    <li><u>Title</u>: the title of the panel (optional)</li>
    <li><u>Signal Label</u>: the string to appear in the legend associated with the signal. If
      no label is defined, the definition of the Y axis of the signal is displayed.</li>
    <li>&nbsp;<u>Y</u>: the y axis of the signal. X and Y expression can be expanded by means of
      the Expand Expr. button.</li>
    <li>&nbsp;<u>Y</u> label: the label associated with y axis (optional). </li>
    <li>&nbsp;<u>X</u>: the x axis of the signal (optional, see below how jScope handles the
      case in which no x axis is specified)</li>
    <li>&nbsp;<u>X label:</u> the label associated with x axis (optional)</li>
    <li><u>Xmin, Xmax, Ymin, Ymax</u>: maximum and minimum values for x and y axis (optional)</li>
    <li><u>Experiment:</u> the name of the experiment (pulse file)</li>
    <li><u>Shot</u>: the shot number</li>
    <li><u>Update event:</u> the name of the event which generates an automaic update </li>
    <li><u>Default node</u>: the default position used in the signal definition. The meaning of
      this optional information depends on the actual data server. In MdsDataServer it refers to
      the default node position in the tree-structured pulse file.</li>
  </ul>
</blockquote>

<p>It is possible to define a set of signals using the form: after filling the fields and
pressing &lt;return&gt;, the signal is added to the list. Definitions can be modified by
selecting the signal on the list. To add a new signal to the list, select the first item;
to remove a signal from the list, select it and press &lt;del&gt;. <br>
Clicking the <u>expand expr</u> button, a popup window is displayed, which allows easier
typing of long specifications of the X and Y axis. It is possible then to define maximum
and minimum errors for displaying error bars, by clicking <u>button error...</u>.&nbsp;
Most fields have a toggle button associated with them: when selected, the value of the
corresponding field is taken from the global configuration (see before). For the
definition of the shot field it is also possible to use the bottom shot field. In this
case a set or a range of shots can be defined: a set is specified by the following syntax:
[&lt;sho1&gt;,shot2&gt;, ...]; a range by: &lt;first_shot&gt;:&lt;last_shot&gt;. Once a
signal has been added to the list, the corresponding color and type of marker can be set
first selecting the signal and then using the pull-down menus on the right of the form. <br>
When a signal in the signal list is selected in the Setup data source popup form, it is
possible to define the associated marker and color, as well to define whether the
interpolating line has to be displayed and the marker step, i.e. the number of data points
for each visible marker. </p>

<p>The<strong> Select Wave Panel</strong> item of the Waveform popup menu allows the
selection of the associated waveform (indicated by a red border around the selected
waveform). Waveform selection is used as a fast way for defining waveforms: in this case
the name of the signal can be typed in the bottom <i>Signal</i> text field and inserted in
the selected waveform by pressing &lt;Return&gt;. The name refers only to the Y Value
field of the Setup popup form; all the other parameters are taken from the global
configuration. Multiple waveforms can be inserted by consecutively typing the waveform
name and pressing &lt;Return&gt; in the Signal field. If no wave panel is selected and new
signals are entered, a new panel is created for each signal. </p>

<p>The other two items <strong>Position legend</strong> and <strong>Remove legend</strong>
of the Waveform popup menu allow the definition of legend for the signals associated with
the waveform. The legend can be activated/deactivated and positioned where needed in the
waveform window. The associated labels associated with the signals are displayed in the
legend. If no label is associated with a given signal, the Y-value name is displayed
instead. </p>

<p>The <strong>Signals</strong><i> </i>item of the Waveform popup menu allows a rapid
activation/deactivation of the currently defined signals. It is useful when dealing with
multiple signals to individually define their visibility in the waveform panel. </p>

<p>The <strong>Marker, Marker-step, Colors</strong> and <strong>Interpolate</strong> items
of the Waveform popup menu are active only in point mode, i.e. when one signal is
selected, and allow a rapid definition of the associated graphical configuration without
opening the Setup data source popup form. </p>

<p>The other items of the popup list allow rescalings of waveforms, and their meanings are
clear from the associated label. </p>

<p align="left">Finally the last item <strong>Save as Text</strong> writes the displayed
waveforms points in a text file, as described before.. </p>

<p align="center"><br>
<b><font size="+2">jScope and Images</font></b> </p>

<p><br>
It is possible with jScope to look at sequences of frames (usually produced by a camera)
and to correlate them with other waveforms. Using standard jdk, it is possible to look at
gif, jpeg and bitmap images. It is also possible to look at other formats by installing
the standard java extension JAI (Java Advanced Imaging). <br>
A jScope panel can be connected to a sequence of frames by selecting the isimage check
box in the data setup dialog. When image mode is selected, the fields of the setup data
dialog are changed and looks like the following: <br>
</p>

<p align="center"><img src="image_setup.jpg" width="776" height="321"
alt="image_setup.jpg (36233 byte)"> <br>
&nbsp; </p>

<blockquote>
  <p>where the fields have the following meaning <ul>
    <li><u>Title</u>: title written above the image</li>
    <li><u>Frames</u>: frame sequence name (the following section will explain how names are
      associated with frame sequences)</li>
    <li><u>Times</u>: defines the time to be associated with each frame. If timing information
      is stored into the frame set, there is no need to fill this field. Otherwise it will refer
      to a vector of times.</li>
    <li><u>t min, t.max</u>: defines minimum and maximum time to be considered in the frame
      sequence. NOTE: this field is very important for very large sequences of frames. jScope in
      fact discards frames whose time is outside the specified interval, thus freeing memory
      resources. The default value(as specified by the associated checkboxes) is taken from xmin
      and xmax fields of the global setting.</li>
    <li><u>Y label</u>: the label associated with y axis (optional)</li>
    <li><u>X label:</u> the label associated with x axis (optional)</li>
    <li><u>Pix Xmin, Pix Xmax, Pix Ymin, Pix Ymax</u>: maximum and minimum values for the region
      of interest in the image(in pixel)</li>
    <li><u>Experiment:</u> the name of the experiment (pulse file)</li>
    <li><u>Shot</u>: the shot number</li>
    <li><u>Update event:</u> the name of the event which generates an automatic update.</li>
    <li><u>Default node</u>: the default position in teh signal definition.</li>
    <li><u>Keep ratio</u>: maintain original aspect ratio in image resizing.</li>
    <li><u>Flip horizontal, Flip vertical:</u> optional image flip.</li>
  </ul>
  <p>and the checkboxes indicate whether the corresponding value is taken from the global
  setup. <br>
  Once the frame sequence has been loaded, the first frame of the sequence is displayed.
  When in zoom mode, it is possible to enlarge portions of the image. When in point mode,
  the frame sequence is synchronized with the other displayed waveforms. This means that
  moving the cursor over a waveform will also update the displayed frame accordingly. When
  in point mode, &lt;ctrl&gt;MB1 click will proceed one frame further (moving in
  correspondence the cursor over the other waveforms). Conversely, &lt;shift&gt;MB1 click
  will go back one frame. <br>
  When a panel is displaying a frame sequence, the popup menu will look as follows: </p>
  <p align="center"><img src="frame_popup.jpg" width="750" height="550"
  alt="frame_popup.jpg (144626 byte)"> </p>
  <p>where some frame-specific menu items are defined as follows(the others have the same
  meaning as when looking at waveforms): <ul>
    <li><u>Start play</u>: start frame animation. When in zoom mode, the cursor is moved over
      the other waveforms, and animation is performed in step for the other frame panels. During
      animation the item is changed to stop play for stopping the animation.</li>
    <li><u>Show profile dialog</u>: enable a popup dialog showing X,Y and Z profiles centered at
      the selected point (when in point mode).</li>
    <li><u>Autoscale</u>: used to come back to the original frame width after zooming.</li>
    <li><u>Autoscale all images</u>: the same as above, performed on all the frame panels.</li>
  </ul>
  <p><br>
  <b><font size="+1">How to integrate frame sequences in jScope using MDSplus</font></b> (<strong>MdsDataProvider</strong>)</p>
  <p>When using a MDSplus data server (mdsip) for getting data in jScope, the following TDI
  functions must be provided for displaying frame sequences, and will be invoked by jScope
  in the given sequence: <br>
  &nbsp; <ul>
    <li><b>JavaGetAllFrames(in _experiment, in_frame_name, in_shot)</b> : this TDI function
      receive the experiment (string), the shot (int) and the frame sequence name(string) as
      defined in the popup dialog. This fun will return 0 if frames are stored in separate
      items, thus making jScope separately request each frame of the request. Currently this fun
      will return a non zero value only for multiframe gif format implemented at CMOD. In this
      case, the content of the file is returned in the form of a byte array as it stands (it
      will be decoded by jScope) and the following funs are <u>not</u> called.</li>
    <li><b>JavaGetFrameTimes(in _experiment, in _frame_name, in _shot):</b> this TDI function
      receives the same parameters of the above function, and will return an array of times,
      specifying the ime associated with each frame.</li>
    <li><b>JavaGetFrameAt(in _experiment, in _frame_name, in _shot, in _frame_idx): </b>this TDI
      function receives in addition the index of the required frame in the frame sequence. It
      will be called by jScope as many times as the dimension of the time vector returned by
      JavaGetFrameTimes, and will provide the selected image (frame) as it stands in the form of
      a byte array.</li>
  </ul>
</blockquote>
<b><font size="+1">

<p></font></b>&nbsp;</p>

<p align="left"><font size="6"><b>The property file of jScope</b></font><big><big><big><big><big><big>
</big></big></big></big></big></big><br>
When started, jScope looks for the jScope.properties file. This file allows user
configuration of jScope and may look as follows: </p>

<pre style="font-family: serif; padding-top: 0px"><small>jScope.directory=N:\\Taliercio\\Applicazioni JAVA\\jScope\\config_scope
jScope.cache_directory=
jScope.cache_size=
jScope.reversed=false
jScope.grid_mode=Dotted
jScope.x_grid=5
jScope.y_grid=5
jScope.item_color_0=Black,java.awt.Color[r=0,g=0,b=0]
jScope.item_color_1=Blue,java.awt.Color[r=0,g=0,b=255]
jScope.item_color_2=Cyan,java.awt.Color[r=0,g=255,b=255]
jScope.item_color_3=DarkGray,java.awt.Color[r=64,g=64,b=64]
jScope.item_color_4=Gray,java.awt.Color[r=128,g=128,b=128]
jScope.item_color_5=Green,java.awt.Color[r=0,g=255,b=0]
jScope.item_color_6=LightGray,java.awt.Color[r=192,g=192,b=192]
|jScope.item_color_7=Magenta,java.awt.Color[r=255,g=0,b=255]
jScope.item_color_8=Orange,java.awt.Color[r=255,g=200,b=0]
jScope.item_color_9=Pink,java.awt.Color[r=255,g=175,b=175]
jScope.item_color_10=Red,java.awt.Color[r=255,g=0,b=0]
jScope.item_color_11=Yellow,java.awt.Color[r=255,g=255,b=0]</small></pre>

<pre style="font-family: serif; padding-top: 0px"><small>jScope.default_server = 4
jScope.data_server_1.name = Jet MDSPlus data
jScope.data_server_1.class = JetMdsDataProvider</small></pre>

<pre style="font-family: serif; padding-top: 0px"><small>&nbsp;jScope.data_server_2.name=TWU data
jScope.data_server_2.class=TwuDataProvider
jScope.data_server_2.browse_class=TextorBrowseSignals
jScope.data_server_2.browse_url=http://ipptwu.ipp.kfa-juelich.de/</small></pre>

<pre style="font-family: serif; padding-top: 0px"><small>jScope.data_server_3.name=Jet data
jScope.data_server_3.class=JetDataProvider
</small></pre>

<pre style="font-family: serif; padding-top: 0px"><small>jScope.data_server_4.name = RFX data server
jScope.data_server_4.argument = 150.178.3.80
jScope.data_server_4.class=MdsDataProvider
jScope.data_server_4.browse_class=MdsPlusBrowseSignals
jScope.data_server_4.browse_url=http://pdigi9.igi.pd.cnr.it/wwwai/rfx_jscope.html</small></pre>

<pre style="font-family: serif; padding-top: 0px"><small>jScope.data_server_5 = Ftu data server
jScope.data_server_5.argument = 192.107.51.84:8100
jScope.data_server_5.class = FtuDataProvider
</small></pre>

<pre style="font-family: serif; padding-top: 0px"><small>jScope.data_server_6.name = Local MdsPlus data
jScope.data_server_6.class = LocalDataProvider
</small></pre>

<pre style="font-family: serif; padding-top: 0px"><small>jScope.data_server_7 = Demo
jScope.data_server_7.class = DemoDataProvider&nbsp; </small></pre>

<pre style="font-family: serif; padding-top: 0px">The selectable properties of jScope.properties are the following:</pre>

<ul>
  <li><u>jScope.directory</u>&nbsp; defines the default directory for storing and retrieving
    configurations.</li>
  <li><u>jScope.cache_directory</u> defines the cache directory. If the property is not
    defined, caced data are saved in /home_dir/jScopeCache.</li>
  <li><u>jScope.cache_size</u> defines the maximum cache size (default 16 MBytes)</li>
  <li><u>jScope.grid_mode</u> defines the grid selection.</li>
  <li><u>jScope.x_grid</u> defines the tentative number of x labels.</li>
  <li><u>jScope.y_grid</u> defines the tentative number of y labels.</li>
  <li><u>jScope.item_color_n</u> defines the nth color in the color palette</li>
  <li><u>jScope.reversed</u> if true defines black background.</li>
  <li><u>jScope.vertical_offset</u> defines the dimension of the border between the drawn
    waveforms and the top and bottom limits of the panel.</li>
  <li><u>jScope.vertical_offset</u> defines the dimension of the border between the drawn
    waveforms and the left and right limits of the panel.</li>
  <li>j<u>Scope.http_proxy_host</u> defines the proxy server to be used when using HTTP
    connections.</li>
  <li><u>jScope.http_proxy_port</u> defines the port of the proxy server to be used when
    using HTTP connections.</li>
  <li><u>jScope.default_server</u> defined as the index of the default server in the server
    list</li>
</ul>

<p>The following properties define the data servers available in the jScope environment.
The <em>n</em>th data server is defined by the following properties: 

<ul>
  <li><u>jScope.data_server_n.name</u>&nbsp; defines the associated name which will be shown
    in the server list.</li>
  <li><u>jScope.data_server_n.class</u> defines the Java class of the corresponding data
    server</li>
  <li><u>jScope.data_server_n.argument</u> (optional) defines the argument passed to the data
    server after creation. For example in in MdsDataServer the argument defines the ip address
    of the corresponding mdsip server.</li>
  <li><u>jScope.data_server_n.browse_class</u> (optional) defines, if signal browsing enabled,
    the class of the browser which is activated by jScope when the file-&gt;browse signals
    item is selected.</li>
  <li><u>jScope.data_server_n.browse_url</u> (optional) defines, if signal browsing enabled,
    the initial URL for the signal browser.</li>
</ul>

<p align="left"><font size="6"><b>How to adapt jScope to a proprietary data acquisition
system</b></font></p>

<p>Originally developed for MdsPlus, the architecture of jScope is now completely
independent from a particular data system. This means that jScope can be adapted to every
data system. </p>

<p>For a seamless integration of a new data system into the jScope framework, it suffices
to develop the implementation of three Java interfaces. Once such implementations have
been added to the jScope classes, and the declaration of the new data server has been
added into the property file, the data server can be used to visualize signals and frame
sequences with jScope. There is therefore no need of chaging any line of code of the core
jScope application.</p>

<p>The main interface is <em><strong>DataProvider</strong></em>, which defines a set of
methods which need to be implemented. The other two interfaces, <strong><em>WaveData</em></strong>
and <strong><em>FrameData</em></strong>, describe a signal and a frame sequence,
respectively, as they are returned by the data access methods of DataProvider. </p>

<p>For a complete reference of the methods defined in these interfaces, and on how to
implemen them, refer to the <a href="DataProvider.html">javadoc description of
DataProvider</a>.</p>

<p>&nbsp; For further information, you can contact jScope authors at the following e-mail
address:<a href="mailto:manduchi@igi.pd.cnr.it"> <i>manduchi@igi.pd.cnr.it</i></a> <br>
&nbsp; <br>
</p>

<p align="left"><font size="6"><b>jScope related classes</b></font></p>

<p>&nbsp; It is possible to use the plotting classes outside the jScope application. In
particular it is possible to define applets for plotting signals, and to integrate
plotting classes into other java C/C++ application.<br>
The plotting capabilities are exported by the <em><strong> CompositeWaveDisplay</strong></em>
class. Detailed information on how to use CompositeWaveDisplay class is provided<a
href="CompositeWaveDisplay.html"> here</a>. </p>

<blockquote>
  <p>&nbsp;</p>
</blockquote>
</body>
</html>
